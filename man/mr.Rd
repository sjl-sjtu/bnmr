% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mr.R
\name{mr}
\alias{mr}
\title{Title Causal estimation by Bayesian Mendelian randomization with shrinkage prior to cope with pleiotropy}
\usage{
mr(
  df,
  selectsnp,
  exposureName,
  outcomeName,
  mr_model = "linear",
  prior = "horseshoe",
  init = "median",
  n.iter = 5000,
  n.chain = 4
)
}
\arguments{
\item{df}{a data frame which contains data of IVs, specified exposure and outcome.}

\item{selectsnp}{a vector of string containing the column names of df corresponding to the IV used in MR.}

\item{exposureName}{a string which is a column name of df corresponding to the exposure studied.}

\item{outcomeName}{a string which is a column name of df corresponding to the outcome studied.}

\item{mr_model}{model for MR. Possible values are "linear" or "logit". Default is "linear".}

\item{prior}{a string represented shrinkage prior used in estimation. It can be "horseshoe", "lasso", "hyperlasso", "spikeslabBernoulli", "spikeslabUniform". Default is "horseshoe".}

\item{init}{the init value of theta for MCMC estimation. It can be a specific numeric or a string of "TSLS", "median", "egger" and "ivw", which means the initial value of the iteration will be calculated automatically by the above method. Default is "median".}

\item{n.iter}{an integer standing for the number of iterations. Default is 5000.}

\item{n.chain}{the number of chains in MCMC sampling. Default is 4.}
}
\value{
a list containing:
  \item{betaList}{a vector cantaining the result of MCMC sampling of the causal parameter we want to estimate.}
  \item{mean}{the mean estimate of the causal parameter.}
  \item{se}{the standard error of the estimation.}
  \item{lower}{the lower boundary of the 95\% CI of the causal estimation.}
  \item{upper}{the upper boundary of the 95\% CI of the causal estimation.}
  \item{Rhat}{a indicator to measure the convergence (at convergence, Rhat <= 1.1).}
}
\description{
Title Causal estimation by Bayesian Mendelian randomization with shrinkage prior to cope with pleiotropy
}
\examples{
n <- 2000
p <- 200
snps <- replicate(p,sample(1:3,n,replace = TRUE))
snps <- apply(snps,2,as.numeric)
snpname <- paste0("g",1:p)
df <- as.data.frame(snps)
colnames(df) <- snpname
truesnp <- paste0("g",sample(1:p,50))
df$x <- as.matrix(df[,truesnp])\%*\%rnorm(50,0.05,0.05)+rnorm(n,0,1)
df$y <- 0.5*df$x+rnorm(n,0,1)
model <- mr(df,truesnp,"x","y")

}
